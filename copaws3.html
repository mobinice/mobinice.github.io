<!doctype html>
<html lang="zh-TW" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Copaws å¯µç‰©æ—¥è¨˜</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700;800&amp;display=swap" rel="stylesheet">
  <style>
    /* æ ¸å¿ƒä½ˆå±€ï¼šé–å®šè¦–çª—é«˜åº¦ï¼Œç¢ºä¿å°èˆªæ¬„å›ºå®š */
    html, body {
      height: 100%;
      margin: 0;
      overflow: hidden;
      box-sizing: border-box;
      font-family: 'Nunito', sans-serif;
    }

    .tab-active {
      color: #0c5832;
      border-bottom: 3px solid #0c5832;
    }
    
    .paw-button {
      transition: all 0.3s ease;
      position: relative;
    }
    
    .paw-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(12, 88, 50, 0.3);
    }
    
    .paw-button:active { transform: scale(0.95); }
    
    /* æ—¥æ›†æ¨£å¼ï¼šç§»é™¤é‚Šæ¡†æ ¼ç·š */
    .calendar-grid-no-border {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 12px;
    }

    .calendar-day {
      transition: all 0.2s ease;
      position: relative;
      background: transparent;
      border: none;
      height: 70px; /* ç¨å¾®æ’é«˜æ–¹ä¾¿é¡¯ç¤ºå †ç–Š */
    }
    
    .calendar-day:hover { transform: scale(1.08); }
    
    /* ç…§ç‰‡å †ç–Šæ•ˆæœ */
    .photo-stack {
      position: relative;
      width: 100%;
      height: 100%;
    }
    
    .photo-stack-item {
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 6px rgba(0,0,0,0.15);
      transition: transform 0.2s ease;
      background: #eee;
    }
    
    .photo-stack-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    /* å †ç–Šåƒæ•¸ */
    .photo-stack-item:nth-child(1) { transform: translate(0, 0) rotate(0deg); z-index: 3; }
    .photo-stack-item:nth-child(2) { transform: translate(3px, 3px) rotate(4deg); z-index: 2; }
    .photo-stack-item:nth-child(3) { transform: translate(6px, 6px) rotate(-4deg); z-index: 1; }
    
    .calendar-day:hover .photo-stack-item:nth-child(1) { transform: translate(-2px, -2px) rotate(-3deg); }
    
    /* æ—¥æœŸæ•¸å­—é¡è‰²ï¼šçµ±ä¸€ç‚ºç¶ è‰² */
    .day-number {
      position: absolute; 
      bottom: 4px; 
      right: 4px; 
      font-size: 11px;
      background: rgba(255,255,255,0.9); 
      padding: 1px 5px;
      border-radius: 4px; 
      z-index: 10; 
      font-weight: 800; 
      color: #0c5832;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    .no-photo-day {
      color: #0c5832;
      font-weight: 800;
      font-size: 14px;
    }

    /* å‹•ç•« */
    .fade-in { animation: fadeIn 0.3s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    
    .page-transition-out { animation: fadeOutScale 0.4s ease forwards; }
    .page-transition-in { animation: fadeInScale 0.5s ease forwards; }
    @keyframes fadeOutScale { from { opacity: 1; transform: scale(1); } to { opacity: 0; transform: scale(0.95); } }
    @keyframes fadeInScale { from { opacity: 0; transform: scale(1.05); } to { opacity: 1; transform: scale(1); } }
    
    .scrollable { overflow-y: auto; -webkit-overflow-scrolling: touch; }
    .scrollable::-webkit-scrollbar { width: 4px; }
    .scrollable::-webkit-scrollbar-thumb { background: #e5ad3f; border-radius: 4px; }
    
    .detail-page { position: absolute; inset: 0; z-index: 50; }
    
    .paw-icon {
      display: inline-block; animation: pawBounce 2s ease-in-out infinite;
      filter: sepia(100%) saturate(300%) hue-rotate(10deg) brightness(1.1);
    }
    @keyframes pawBounce { 0%, 100% { transform: translateY(0) rotate(0deg); } 50% { transform: translateY(-5px) rotate(-5deg); } }
    
    .login-card { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-radius: 24px; box-shadow: 0 20px 60px rgba(12, 88, 50, 0.2); }
    .input-field { transition: all 0.3s ease; border-color: #c8e6d4; }
    .input-field:focus { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(12, 88, 50, 0.15); border-color: #0c5832; }
    
    .toast {
      position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
      background: #0c5832; color: white; padding: 12px 24px; border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 1000; animation: slideDown 0.3s ease;
    }
    @keyframes slideDown { from { opacity: 0; transform: translate(-50%, -20px); } to { opacity: 1; transform: translate(-50%, 0); } }
    
    .demo-badge {
      display: inline-block; background: linear-gradient(135deg, #e5ad3f 0%, #d99e2f 100%);
      color: white; padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: bold; margin-left: 8px;
    }
  </style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="bg-gradient-to-br from-green-100 via-emerald-50 to-teal-100">
  <div class="w-full h-full bg-white flex flex-col relative">
   
   <!-- Login Screen -->
   <div id="login-screen" class="absolute inset-0 z-[60] flex flex-col items-center justify-center p-8 overflow-hidden" style="background: linear-gradient(to bottom right, #e7f5ee, #d4ebe1, #c8e6d4);">
    <div class="absolute top-10 left-10 text-6xl opacity-30 paw-icon">ğŸ¾</div>
    <div class="absolute bottom-20 right-10 text-6xl opacity-30 paw-icon" style="animation-delay: 0.5s;">ğŸ¾</div>
    <div class="login-card w-full max-w-sm p-8 relative z-10">
     <div class="text-center mb-8">
      <div class="text-6xl mb-4 paw-icon">ğŸ¾</div>
      <h1 class="text-4xl font-extrabold mb-2" style="color: #0c5832;">Copaws</h1>
      <p class="text-gray-600 text-sm">è¨˜éŒ„å¯¶è²çš„æ¯ä¸€åˆ» â¤ï¸</p>
     </div>
     
     <div id="auth-step-1" class="space-y-4">
      <div><label class="block text-sm font-semibold text-gray-700 mb-2">Email æˆ–æ‰‹æ©Ÿè™Ÿç¢¼</label> <input type="text" id="auth-input" class="input-field w-full px-4 py-3 border-2 rounded-xl focus:outline-none" placeholder="è¼¸å…¥ Email æˆ–æ‰‹æ©Ÿè™Ÿç¢¼"></div>
      <button id="auth-continue-btn" class="paw-button w-full text-white font-bold py-3 rounded-xl" style="background: linear-gradient(to right, #0c5832, #0a4528);"> ç¹¼çºŒ </button>
      <div class="text-center text-sm text-gray-500 my-4">æˆ–</div>
      <button id="google-login-btn" class="w-full bg-white border-2 border-gray-300 text-gray-700 font-semibold py-3 rounded-xl hover:bg-gray-50 flex items-center justify-center gap-2">
       <svg class="w-5 h-5" viewbox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" /><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" /><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" /><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" /></svg> ä½¿ç”¨ Google ç™»å…¥
      </button>
     </div>

     <div id="registration-form" class="hidden space-y-4">
      <div class="text-center mb-4"><h2 class="text-2xl font-bold" style="color: #0c5832;">å»ºç«‹å¸³è™Ÿ</h2></div>
      <div class="grid grid-cols-2 gap-3">
        <div><label class="block text-xs font-semibold text-gray-700 mb-1">å¯µç‰©é¡åˆ¥</label> <select id="pet-type" class="input-field w-full px-3 py-2 border-2 rounded-lg text-sm"><option value="dog">ğŸ¶ ç‹—ç‹—</option><option value="cat">ğŸ± è²“å’ª</option></select></div>
        <div><label class="block text-xs font-semibold text-gray-700 mb-1">æ€§åˆ¥</label> <select id="pet-gender" class="input-field w-full px-3 py-2 border-2 rounded-lg text-sm"><option value="male">â™‚ å…¬</option><option value="female">â™€ æ¯</option></select></div>
      </div>
      <div><label class="block text-xs font-semibold text-gray-700 mb-1">å¯µç‰©åå­—</label> <input type="text" id="pet-name" class="input-field w-full px-3 py-2 border-2 rounded-lg text-sm" placeholder="Lucky"></div>
      <div><label class="block text-xs font-semibold text-gray-700 mb-1">å“ç¨®</label> <input type="text" id="pet-breed" class="input-field w-full px-3 py-2 border-2 rounded-lg text-sm" placeholder="ä¾‹å¦‚ï¼šæŸ´çŠ¬"></div>
      <div class="grid grid-cols-3 gap-3">
        <div><label class="block text-xs font-semibold text-gray-700 mb-1">å¹´é½¡</label> <input type="number" id="pet-age" class="input-field w-full px-3 py-2 border-2 rounded-lg text-sm" placeholder="æ­²"></div>
        <div><label class="block text-xs font-semibold text-gray-700 mb-1">æ¯›è‰²</label> <input type="text" id="pet-color" class="input-field w-full px-3 py-2 border-2 rounded-lg text-sm" placeholder="é»ƒè‰²"></div>
        <div><label class="block text-xs font-semibold text-gray-700 mb-1">é«”é‡</label> <input type="number" id="pet-weight" class="input-field w-full px-3 py-2 border-2 rounded-lg text-sm" placeholder="kg"></div>
      </div>
      <button id="register-submit-btn" class="paw-button w-full text-white font-bold py-3 rounded-xl mt-4" style="background: linear-gradient(to right, #0c5832, #0a4528);"> é–‹å§‹è¨˜éŒ„ ğŸ¾ </button>
      <button id="back-to-login-btn" class="w-full text-gray-600 text-sm"> â† è¿”å› </button>
     </div>
    </div>
   </div>

   <!-- Main App -->
   <div id="main-app" class="h-full flex flex-col hidden overflow-hidden">
    <header class="h-12 flex-shrink-0 flex items-center justify-center px-6" style="background: linear-gradient(to right, #0c5832, #0a4528);">
     <h1 id="app-title" class="text-white font-bold text-lg">ğŸ¾ Copaws</h1><span class="demo-badge">ç¤ºç¯„æ¨¡å¼</span>
    </header>

    <main class="flex-1 overflow-hidden relative">
      <div class="absolute inset-0 flex flex-col">
        
        <!-- Upload Tab -->
        <section id="upload-tab" class="flex-1 h-full p-4 overflow-auto" style="background: linear-gradient(to bottom, #e7f5ee, #ffffff);">
         <div class="text-center mb-3">
          <h2 class="text-xl font-bold mb-1" style="color: #0c5832;">ä¸Šå‚³ç…§ç‰‡ ğŸ“¸</h2>
          <p class="text-gray-600 text-xs">è¨˜éŒ„æ¯›å­©çš„ç¾å¥½æ™‚å…‰</p>
         </div>
         <label for="file-input" id="upload-btn" class="paw-button text-white font-bold py-3 rounded-xl flex items-center justify-center gap-2 cursor-pointer mb-3" style="background: linear-gradient(to right, #e5ad3f, #d99e2f);"> <span class="text-2xl">ğŸ“·</span> <span>é¸æ“‡ç…§ç‰‡</span> </label>
         <input type="file" id="file-input" accept="image/*" class="hidden">
         
         <div id="upload-form-container" class="hidden space-y-3 pb-8">
          <div id="image-preview-wrapper" class="relative rounded-xl overflow-hidden shadow-lg"><img id="image-preview" class="w-full object-contain max-h-48"> <button id="remove-image-btn" class="absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center">âœ•</button></div>
          <div><label class="block text-xs font-bold mb-1" style="color: #0c5832;">å¯«ä¸‹å›æ†¶</label> <textarea id="photo-note" class="input-field w-full px-3 py-2 border-2 rounded-xl focus:outline-none resize-none text-sm" rows="3" placeholder="ä»Šå¤©ç™¼ç”Ÿäº†ä»€éº¼æœ‰è¶£çš„äº‹å‘¢ï¼Ÿ ğŸ˜Š"></textarea></div>
          <div><label class="block text-xs font-bold mb-1" style="color: #0c5832;">é¸æ“‡æ—¥æœŸ</label> <input type="date" id="photo-date" class="input-field w-full px-3 py-2 border-2 rounded-xl focus:outline-none text-sm"></div>
          <button id="save-photo-btn" class="paw-button w-full text-white font-bold py-3 rounded-xl" style="background: linear-gradient(to right, #0c5832, #0a4528);"> é–‹å§‹ä¸Šå‚³ âœ¨ </button>
          
          <!-- é€²åº¦æ¢åŒ…å«ç™¾åˆ†æ¯” -->
          <div id="upload-progress-container" class="hidden">
            <div class="flex justify-between items-center mb-1">
              <span class="text-[10px] font-bold text-emerald-800">ä¸Šå‚³é€²åº¦</span>
              <span id="upload-pct-text" class="text-[10px] font-bold text-emerald-800">0%</span>
            </div>
            <div class="w-full h-2 bg-gray-200 rounded-full overflow-hidden">
              <div id="upload-progress-bar" class="h-full bg-emerald-500 transition-all duration-300" style="width: 0%;"></div>
            </div>
          </div>

          <div id="upload-success" class="hidden p-4 rounded-xl border-2 text-center bg-emerald-50 border-emerald-200 shadow-sm">
            <p class="font-bold text-emerald-800 mb-2">æˆåŠŸç´€éŒ„ç¾å¥½å›æ†¶~ âœ¨</p>
            <button id="upload-another-btn" class="paw-button w-full bg-emerald-800 text-white py-2 rounded-lg text-sm font-bold">ç¹¼çºŒä¸Šå‚³ä¸‹ä¸€å¼µ</button>
          </div>
         </div>
        </section>

        <!-- Calendar Tab -->
        <section id="calendar-tab" class="flex-1 h-full p-5 overflow-auto hidden" style="background: linear-gradient(to bottom, #e7f5ee, #ffffff);">
         <div class="flex items-center justify-between mb-6">
          <button id="prev-month" class="w-10 h-10 rounded-full bg-emerald-50 text-emerald-800 flex items-center justify-center font-bold">â—€</button>
          <h2 id="current-month" class="text-xl font-extrabold text-[#0c5832]"></h2>
          <button id="next-month" class="w-10 h-10 rounded-full bg-emerald-50 text-emerald-800 flex items-center justify-center font-bold">â–¶</button>
         </div>
         <div class="grid grid-cols-7 gap-2 mb-4 text-center text-xs font-bold text-gray-400 uppercase tracking-wider">
          <div>æ—¥</div><div>ä¸€</div><div>äºŒ</div><div>ä¸‰</div><div>å››</div><div>äº”</div><div>å…­</div>
         </div>
         <div id="calendar-grid" class="calendar-grid-no-border"></div>
        </section>

        <!-- Profile Tab -->
        <section id="profile-tab" class="flex-1 h-full p-5 overflow-auto hidden" style="background: linear-gradient(to bottom, #e7f5ee, #ffffff);">
         <div class="flex flex-col items-center mb-6">
          <div id="pet-avatar-display" class="w-24 h-24 rounded-full flex items-center justify-center text-5xl overflow-hidden border-4 shadow-xl border-emerald-800 bg-emerald-100">ğŸ¶</div>
          <label for="avatar-input" class="mt-2 text-xs font-bold text-emerald-700 underline cursor-pointer">æ›´æ›é ­åƒ</label>
          <input type="file" id="avatar-input" accept="image/*" class="hidden">
          <h3 id="profile-pet-name" class="text-xl font-bold mt-2">Lucky</h3>
         </div>
         <div class="space-y-2 pb-6">
          <div class="rounded-lg p-2 border-2 bg-white border-emerald-100"><label class="text-[10px] font-bold text-emerald-800 block">å¹´é½¡</label><input type="number" id="profile-age" class="w-full text-sm focus:outline-none"></div>
		  <div class="rounded-lg p-2 border-2 bg-white border-emerald-100"><label class="text-[10px] font-bold text-emerald-800 block">æ€§åˆ¥</label><select id="profile-gender" class="w-full text-sm focus:outline-none"><option value="male">â™‚ å…¬</option><option value="female">â™€ æ¯</option></select></div>
          <div class="rounded-lg p-2 border-2 bg-white border-emerald-100"><label class="text-[10px] font-bold text-emerald-800 block">é¡åˆ¥</label><select id="profile-type" class="w-full text-sm focus:outline-none"><option value="dog">ğŸ¶ ç‹—ç‹—</option><option value="cat">ğŸ± è²“å’ª</option></select></div>
          <div class="rounded-lg p-2 border-2 bg-white border-emerald-100"><label class="text-[10px] font-bold text-emerald-800 block">é«”é‡</label><input type="number" id="profile-weight" class="w-full text-sm focus:outline-none"></div>
          <div class="rounded-lg p-2 border-2 bg-white border-emerald-100"><label class="text-[10px] font-bold text-emerald-800 block">å“ç¨®</label><input type="text" id="profile-breed" class="w-full text-sm focus:outline-none"></div>
          <div class="rounded-lg p-2 border-2 bg-white border-emerald-100"><label class="text-[10px] font-bold text-emerald-800 block">æ¯›è‰²</label><input type="text" id="profile-color" class="w-full text-sm focus:outline-none"></div>
         </div>
         <button id="save-profile-btn" class="paw-button w-full text-white font-bold py-3 rounded-xl" style="background: linear-gradient(to right, #0c5832, #0a4528);"> å„²å­˜è³‡æ–™ âœ¨ </button>
         <button id="logout-btn" class="w-full mt-4 bg-gray-100 text-gray-400 py-2 rounded-xl font-bold text-xs">ç™»å‡ºå¸³è™Ÿ</button>
        </section>
      </div>
    </main>

    <!-- Bottom Nav -->
    <nav class="h-20 flex-shrink-0 bg-white flex border-t border-emerald-100 shadow-[0_-4px_15px_rgba(0,0,0,0.03)]">
     <button id="nav-upload" class="flex-1 flex flex-col items-center justify-center tab-active transition"><svg class="w-6 h-6 mb-1" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" /></svg><span class="text-[10px] font-bold">ç´€éŒ„</span></button>
     <button id="nav-calendar" class="flex-1 flex flex-col items-center justify-center text-gray-400 transition"><svg class="w-6 h-6 mb-1" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" /></svg><span class="text-[10px] font-bold">å›æ†¶</span></button>
     <button id="nav-profile" class="flex-1 flex flex-col items-center justify-center text-gray-400 transition"><svg class="w-7 h-7 mb-1" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24"><circle cx="12" cy="4" r="1.5" /><circle cx="19" cy="8" r="1.5" /><circle cx="5" cy="8" r="1.5" /><path d="M19.5 13c-.83 0-1.5.67-1.5 1.5 0 .15.03.29.07.43C15.4 15.35 13.21 16 12 16c-1.21 0-3.4-.65-6.07-1.07.04-.14.07-.28.07-.43 0-.83-.67-1.5-1.5-1.5S3 13.67 3 14.5c0 .66.42 1.23 1.01 1.44C5.37 18.07 7.61 21 12 21s6.63-2.93 7.99-5.06c.59-.21 1.01-.78 1.01-1.44 0-.83-.67-1.5-1.5-1.5z" stroke-linecap="round" stroke-linejoin="round" /></svg><span class="text-[10px] font-bold">å¯¶è²</span></button>
    </nav>
   </div>

   <!-- Detail Page -->
   <div id="detail-page" class="detail-page hidden bg-white">
    <div class="h-full flex flex-col slide-up">
     <header class="h-14 flex-shrink-0 flex items-center px-4 border-b bg-white">
      <button id="back-btn" class="w-10 h-10 rounded-full bg-emerald-800 text-white flex items-center justify-center shadow-lg font-bold">â—€</button>
      <h2 id="detail-title" class="flex-1 text-center font-extrabold text-[#0c5832]">æ—¥æœŸ</h2>
      <div class="w-10"></div>
     </header>
     <div id="detail-content" class="flex-1 p-4 scrollable bg-gray-50/50"></div>
     <div id="next-date-hint" class="h-12 flex-shrink-0 flex items-center justify-center bg-emerald-50 text-emerald-800 text-[10px] font-bold tracking-widest">â†“â†“ ç¹¼çºŒå‘ä¸‹æ»‘å‹•ç¿»é–±ä¸‹ä¸€å¤© â†“â†“</div>
    </div>
   </div>
  </div>

  <script>
    // è³‡æ–™æ“´å……è‡³ 80% çš„æ—¥æœŸéƒ½æœ‰ç…§ç‰‡ï¼Œä¿®æ­£ 1/9 é€£çµ
    const samplePhotos = {
      '2025-01-01': [{ image: 'https://images.unsplash.com/photo-1517841905240-472988babdf9?w=600', note: 'å…ƒæ—¦å¿«æ¨‚ï¼èˆ‡ Lucky çš„ç¬¬ä¸€å¼µåˆç…§ ğŸ†', time: '00:15' }, { image: 'https://images.unsplash.com/photo-1518717758536-85ae29035b6d?w=600', note: 'ç¡å¾—å¥½æ²‰', time: '10:00' }],
      '2025-01-02': [{ image: 'https://images.unsplash.com/photo-1583511655857-d19b40a7a54e?w=600', note: 'å‡ºé–€æ•£æ­¥ï¼ä»Šå¤©é‡åˆ°äº†æŸ´çŠ¬æœ‹å‹ ğŸ•', time: '09:00' }, { image: 'https://images.unsplash.com/photo-1587300003388-59208cc962cb?w=600', note: 'ç©å¾—æ»¿è‡‰æ³¥åœŸ', time: '10:30' }],
      '2025-01-03': [{ image: 'https://images.unsplash.com/photo-1534361960057-19889db9621e?w=600', note: 'è²·äº†æ–°ç©å…·ï¼Œå®ƒå’¬è‘—ä¸æ”¾ ğŸ¦´', time: '15:00' }, { image: 'https://images.unsplash.com/photo-1552053831-71594a27632d?w=600', note: 'æœŸå¾…é»å¿ƒçš„è¡¨æƒ…', time: '16:00' }],
      '2025-01-04': [{ image: 'https://images.unsplash.com/photo-1548199973-03cce0bbc87b?w=600', note: 'è‰åœ°è·‘è·‘æ—¥ï¼é«”åŠ›çœŸçš„å¾ˆå¥½ ğŸ’š', time: '14:20' }, { image: 'https://images.unsplash.com/photo-1530281700549-e82e7bf110d6?w=600', note: 'è¿½çƒçƒä¸­', time: '14:50' }],
      '2025-01-05': [{ image: 'https://images.unsplash.com/photo-1450778869180-41d0601e046e?w=600', note: 'é™ªä¸»äººçœ‹æ›¸ï¼ˆå…¶å¯¦æ˜¯åœ¨ç¡è¦ºï¼‰ğŸ’¤', time: '11:00' }, { image: 'https://images.unsplash.com/photo-1507146426996-ef05306b995a?w=600', note: 'å¥½æº«é¦¨', time: '12:00' }],
      '2025-01-06': [{ image: 'https://images.unsplash.com/photo-1561037404-61cd46aa615b?w=600', note: 'å¤©æ°£å†·ï¼Œå¹«å®ƒç©¿ä¸Šå°å¤–å¥— ğŸ§¥', time: '10:30' }, { image: 'https://images.unsplash.com/photo-1537151608828-ea2b11777ee8?w=600', note: 'å¸¥æ°£çš„å´è‡‰', time: '11:00' }],
      '2025-01-07': [{ image: 'https://images.unsplash.com/photo-1558788353-f76d92427f16?w=600', note: 'ä»Šå¤©æ´—æ¾¡æ¾¡ï¼Œè®Šå¾—å¾ˆé¦™ âœ¨', time: '14:00' }, { image: 'https://images.unsplash.com/photo-1415369629372-26f2fe60c467?w=600', note: 'å‰›æ´—å®Œè®Šæˆäº†è½æ¹¯é›', time: '15:00' }],
      '2025-01-08': [{ image: 'https://images.unsplash.com/photo-1516734212186-a967f81ad0d7?w=600', note: 'åœ¨å¾Œé™¢ç™¼ç¾äº†å°æ˜†èŸ² ğŸ¦‹', time: '16:15' }, { image: 'https://images.unsplash.com/photo-1494947665470-20322015e3a8?w=600', note: 'å°ˆæ³¨çš„çœ¼ç¥', time: '16:40' }],
      '2025-01-09': [{ image: 'https://images.unsplash.com/photo-1516734212186-a967f81ad0d7?w=600', note: 'ä»Šå¤©å»çœ‹äº†é†«ç”Ÿï¼Œæ‰“é‡å¥½å‹‡æ•¢ ğŸ’‰', time: '11:00' }, { image: 'https://images.unsplash.com/photo-1583337130417-3346a1be7dee?w=600', note: 'å›å®¶ç«‹åˆ»è¨æ‘¸æ‘¸', time: '12:30' }],
      '2025-01-10': [{ image: 'https://images.unsplash.com/photo-1425082661705-1834bfd09dca?w=600', note: 'æ…µæ‡¶çš„åˆå¾Œï¼Œé™½å…‰ç‘é€²ä¾†çœŸèˆ’æœ â˜€ï¸', time: '15:20' }, { image: 'https://images.unsplash.com/photo-1510771463146-e89e6e86560e?w=600', note: 'ç¡åˆ°ç¿»è‚šäº†', time: '16:00' }],
      '2025-01-12': [{ image: 'https://images.unsplash.com/photo-1544568100-847a948585b9?w=600', note: 'é€±æœ«å»å¯µç‰©å‹å–„é¤å»³ ğŸ”', time: '13:00' }, { image: 'https://images.unsplash.com/photo-1534361960057-19889db9621e?w=600', note: 'ä¹–ä¹–ç­‰åƒé£¯', time: '13:45' }],
      '2025-01-14': [{ image: 'https://images.unsplash.com/photo-1516734212186-a967f81ad0d7?w=600', note: 'å­¸æœƒäº†ã€Œæ“ŠæŒã€ï¼Œå®ƒå¥½è°æ˜ ğŸ–ï¸', time: '20:10' }, { image: 'https://images.unsplash.com/photo-1552053831-71594a27632d?w=600', note: 'é–‹å¿ƒçš„è¡¨æƒ…', time: '20:30' }],
      '2025-01-15': [{ image: 'https://images.unsplash.com/photo-1548199973-03cce0bbc87b?w=600', note: 'å…¬åœ’å¤§èšæœƒï¼èªè­˜å¥½å¤šæ–°æœ‹å‹ ğŸ¶', time: '10:30' }, { image: 'https://images.unsplash.com/photo-1587300003388-59208cc962cb?w=600', note: 'å¤§å®¶ä¸€èµ·è·‘è·‘', time: '11:15' }],
      '2025-01-17': [{ image: 'https://images.unsplash.com/photo-1530281700549-e82e7bf110d6?w=600', note: 'ä»Šå¤©å¤©æ°£è½‰æ¶¼ï¼Œçª©åœ¨æ¯¯å­è£¡ ğŸ›‹ï¸', time: '21:00' }, { image: 'https://images.unsplash.com/photo-1518717758536-85ae29035b6d?w=600', note: 'æš–çƒ˜çƒ˜çš„', time: '21:30' }],
      '2025-01-18': [{ image: 'https://images.unsplash.com/photo-1450778869180-41d0601e046e?w=600', note: 'å¹«å®ƒå‰ªæŒ‡ç”²ï¼Œé›–ç„¶è‡‰å¾ˆè‡­ä½†å¾ˆé…åˆ ğŸ’…', time: '14:00' }, { image: 'https://images.unsplash.com/photo-1507146426996-ef05306b995a?w=600', note: 'ä¸ç”˜é¡˜çš„æ¨£å­', time: '14:20' }],
      '2025-01-20': [{ image: 'https://images.unsplash.com/photo-1517841905240-472988babdf9?w=600', note: 'å®ƒæœƒè‡ªå·±å¼ç¢—ä¾†ï¼Œæš—ç¤ºè‚šå­é¤“äº† ğŸš', time: '18:00' }, { image: 'https://images.unsplash.com/photo-1510771463146-e89e6e86560e?w=600', note: 'è¨é£¯ä¸­', time: '18:15' }],
      '2025-01-21': [{ image: 'https://images.unsplash.com/photo-1494947665470-20322015e3a8?w=600', note: 'ç©èº²è²“è²“ï¼Œçµæœå°¾å·´éœ²å‡ºä¾†äº† ğŸ•', time: '16:00' }, { image: 'https://images.unsplash.com/photo-1587300003388-59208cc962cb?w=600', note: 'è¢«ç™¼ç¾äº†', time: '16:15' }],
      '2025-01-22': [{ image: 'https://images.unsplash.com/photo-1516734212186-a967f81ad0d7?w=600', note: 'ä¸€èµ·åœ¨å®¢å»³ç©æ‹‰æ‰¯éŠæˆ² ğŸ¾', time: '19:30' }, { image: 'https://images.unsplash.com/photo-1544568100-847a948585b9?w=600', note: 'è¶…æœ‰æ´»åŠ›', time: '20:00' }],
      '2025-01-23': [{ image: 'https://images.unsplash.com/photo-1552053831-71594a27632d?w=600', note: 'ä»Šå¤©çš„çœ¼ç¥ç‰¹åˆ¥æº«æŸ” â¤ï¸', time: '11:00' }, { image: 'https://images.unsplash.com/photo-1510771463146-e89e6e86560e?w=600', note: 'æ·±æƒ…æ³¨è¦–', time: '11:15' }],
      '2025-01-25': [{ image: 'https://images.unsplash.com/photo-1415369629372-26f2fe60c467?w=600', note: 'å¸¶å»å±±ä¸Šèµ°èµ°ï¼Œç©ºæ°£è¶…å¥½ ğŸ”ï¸', time: '10:00' }, { image: 'https://images.unsplash.com/photo-1425082661705-1834bfd09dca?w=600', note: 'ç™»é ‚ç…§', time: '11:30' }],
      '2025-01-26': [{ image: 'https://images.unsplash.com/photo-1517841905240-472988babdf9?w=600', note: 'åœ¨å®¶è£¡èˆ‰è¾¦äº†å°å°çš„é›¶é£Ÿè¶´ ğŸ–', time: '15:00' }, { image: 'https://images.unsplash.com/photo-1518717758536-85ae29035b6d?w=600', note: 'åƒå¾—è¶…é–‹å¿ƒ', time: '15:20' }],
      '2025-01-28': [{ image: 'https://images.unsplash.com/photo-1534361960057-19889db9621e?w=600', note: 'å®ƒç¾åœ¨æœƒè‡ªå·±è·³ä¸Šè»Šï¼Œæº–å‚™å‡ºé–€ ğŸš—', time: '09:00' }, { image: 'https://images.unsplash.com/photo-1507146426996-ef05306b995a?w=600', note: 'çœ‹çª—å¤–é¢¨æ™¯', time: '09:30' }],
      '2025-01-29': [{ image: 'https://images.unsplash.com/photo-1494947665470-20322015e3a8?w=600', note: 'é™ªæˆ‘ä¸€èµ·å·¥ä½œï¼Œå®ƒæ˜¯æœ€å¥½çš„é™ªä¼´ ğŸ’»', time: '14:00' }, { image: 'https://images.unsplash.com/photo-1558788353-f76d92427f16?w=600', note: 'åœ¨æ¡Œä¸‹ç¡è¦º', time: '15:00' }],
      '2025-01-30': [{ image: 'https://images.unsplash.com/photo-1425082661705-1834bfd09dca?w=600', note: 'æœˆåº•äº†ï¼Œå¹«å®ƒç®—ç®—é€™å€‹æœˆåƒäº†å¤šå°‘é›¶é£Ÿ ğŸª', time: '20:00' }, { image: 'https://images.unsplash.com/photo-1544568100-847a948585b9?w=600', note: 'ä¸€è‡‰ç„¡è¾œ', time: '20:15' }]
    };

    let currentDate = new Date(2025, 0, 1);
    let petAvatar = null;
    let petProfile = { name: 'Lucky', age: '', type: 'dog', gender: 'male', weight: '', breed: '', color: '' };
    let isTransitioning = false;

    const detailContent = document.getElementById('detail-content');

    function showToast(message) {
      const t = document.createElement('div');
      t.className = 'toast'; t.textContent = message;
      document.body.appendChild(t);
      setTimeout(() => t.remove(), 2000);
    }

    // ç™»å…¥
    document.getElementById('auth-continue-btn').onclick = () => {
      document.getElementById('registration-form').classList.remove('hidden');
      document.getElementById('auth-step-1').classList.add('hidden');
    };
    document.getElementById('register-submit-btn').onclick = () => {
      petProfile.name = document.getElementById('pet-name').value || 'Lucky';
      petProfile.age = document.getElementById('pet-age').value;
	  petProfile.gender = document.getElementById('pet-gender').value;
      petProfile.breed = document.getElementById('pet-breed').value;
      petProfile.weight = document.getElementById('pet-weight').value;
      petProfile.color = document.getElementById('pet-color').value;
      petProfile.type = document.getElementById('pet-type').value;
      loginUser();
    };
    document.getElementById('google-login-btn').onclick = () => loginUser();

    function loginUser() {
      showToast('ç™»å…¥æˆåŠŸï¼ğŸ¾');
      setTimeout(() => {
        document.getElementById('login-screen').classList.add('hidden');
        document.getElementById('main-app').classList.remove('hidden');
        renderCalendar();
      }, 1000);
    }

    // Tab åˆ‡æ›
    function showTab(id) {
      ['upload', 'calendar', 'profile'].forEach(t => {
        document.getElementById(t + '-tab').classList.add('hidden');
        document.getElementById('nav-' + t).classList.remove('tab-active');
        document.getElementById('nav-' + t).classList.add('text-gray-400');
      });
      document.getElementById(id + '-tab').classList.remove('hidden');
      document.getElementById('nav-' + id).classList.add('tab-active');
      document.getElementById('nav-' + id).classList.remove('text-gray-400');
      if(id === 'calendar') renderCalendar();
      if(id === 'profile') loadProfile();
    }
    document.getElementById('nav-upload').onclick = () => showTab('upload');
    document.getElementById('nav-calendar').onclick = () => showTab('calendar');
    document.getElementById('nav-profile').onclick = () => showTab('profile');

    // æ—¥æ›†æ¸²æŸ“
    function renderCalendar() {
      const year = currentDate.getFullYear();
      const month = currentDate.getMonth();
      document.getElementById('current-month').textContent = `${year} å¹´ ${month + 1} æœˆ`;
      
      const firstDay = new Date(year, month, 1).getDay();
      const daysInMonth = new Date(year, month + 1, 0).getDate();
      const grid = document.getElementById('calendar-grid');
      grid.innerHTML = '';

      for (let i = 0; i < firstDay; i++) grid.appendChild(document.createElement('div'));

      for (let day = 1; day <= daysInMonth; day++) {
        const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
        const photos = samplePhotos[dateStr];
        const cell = document.createElement('button');
        cell.className = 'calendar-day rounded-xl flex items-center justify-center';

        if (photos && photos.length > 0) {
          cell.classList.add('has-entry');
          let stackHtml = '<div class="photo-stack">';
          const displayCount = Math.min(3, photos.length);
          for(let i=0; i<displayCount; i++){
            stackHtml += `<div class="photo-stack-item"><img src="${photos[i].image}"></div>`;
          }
          stackHtml += '</div>';
          cell.innerHTML = `${stackHtml}<span class="day-number">${day}</span>`;
          cell.onclick = () => openDetailPage(dateStr);
        } else {
          cell.innerHTML = `<span class="no-photo-day">${day}</span>`;
        }
        grid.appendChild(cell);
      }
    }

    function openDetailPage(dateStr) {
      renderDetailPage(dateStr);
      document.getElementById('detail-page').classList.remove('hidden');
    }

    function renderDetailPage(dateStr) {
      const [year, month, day] = dateStr.split('-');
      document.getElementById('detail-title').textContent = `${year} å¹´ ${parseInt(month)} æœˆ ${parseInt(day)} æ—¥`;
      const photos = samplePhotos[dateStr] || [];
      detailContent.innerHTML = '';

      photos.forEach((photo, index) => {
        const card = document.createElement('div');
        card.className = 'bg-white rounded-2xl shadow-sm border border-emerald-50 overflow-hidden mb-5 fade-in';
        card.style.animationDelay = `${index * 0.1}s`;
        
        const avatarHtml = petAvatar 
          ? `<img src="${petAvatar}" class="w-8 h-8 rounded-full object-cover border-2 border-emerald-100 shadow-sm">`
          : `<div class="w-8 h-8 rounded-full bg-emerald-100 flex items-center justify-center text-lg border-2 border-white shadow-sm">ğŸ¶</div>`;

        card.innerHTML = `
          <img src="${photo.image}" class="w-full aspect-square object-cover">
          <div class="p-4 flex gap-3 items-start">
            <div class="flex-shrink-0">${avatarHtml}</div>
            <div class="flex-1">
              <p class="text-[#0c5832] text-sm font-semibold leading-relaxed">${photo.note}</p>
              <p class="text-[10px] text-gray-400 mt-2 font-bold italic">ğŸ• ${photo.time}</p>
            </div>
          </div>
        `;
        detailContent.appendChild(card);
      });

      const nextDate = getNextDate(dateStr);
      if (nextDate) {
        document.getElementById('next-date-hint').classList.remove('hidden');
        setupAutoScroll(dateStr);
      } else {
        // å¦‚æœæ²’æœ‰ä¸‹ä¸€å€‹æ—¥æœŸï¼Œéš±è—æç¤ºä¸¦ç§»é™¤æ²å‹•ç›£è½
        document.getElementById('next-date-hint').classList.add('hidden');
        detailContent.onscroll = null;
      }
    }

    function setupAutoScroll(currentDateStr) {
      detailContent.onscroll = () => {
        if (isTransitioning) return;
        // åµæ¸¬æ˜¯å¦æ»‘åˆ°åº•éƒ¨
        if (detailContent.scrollTop + detailContent.clientHeight >= detailContent.scrollHeight - 10) {
          const nextDate = getNextDate(currentDateStr);
          if (nextDate) {
            isTransitioning = true;
            detailContent.classList.add('page-transition-out');
            setTimeout(() => {
              detailContent.scrollTop = 0;
              detailContent.classList.remove('page-transition-out');
              renderDetailPage(nextDate);
              detailContent.classList.add('page-transition-in');
              setTimeout(() => {
                detailContent.classList.remove('page-transition-in');
                isTransitioning = false;
              }, 500);
            }, 400);
          }
        }
      };
    }

    function getNextDate(dateStr) {
      const dates = Object.keys(samplePhotos).sort();
      const idx = dates.indexOf(dateStr);
      if (idx >= 0 && idx < dates.length - 1) {
        return dates[idx + 1];
      }
      return null; // æœ€å¾Œä¸€å€‹æ—¥æœŸå›å‚³ null
    }

// ä¸Šå‚³é‚è¼¯
Â  Â  document.getElementById('file-input').onchange = (e) => {
Â  Â  Â  const file = e.target.files[0];
Â  Â  Â  if(file) {
Â  Â  Â  Â  // --- æ–°å¢ï¼šè¨­å®šé»˜èªæ—¥æœŸç‚ºç•¶å¤© (æ ¼å¼ç‚º YYYY-MM-DD) ---
Â  Â  Â  Â  document.getElementById('photo-date').value = new Date().toISOString().split('T')[0];
        
Â  Â  Â  Â  document.getElementById('image-preview').src = URL.createObjectURL(file);
Â  Â  Â  Â  document.getElementById('upload-form-container').classList.remove('hidden');
Â  Â  Â  Â  document.getElementById('save-photo-btn').classList.remove('hidden');
Â  Â  Â  Â  document.getElementById('upload-success').classList.add('hidden');
Â  Â  Â  Â  document.getElementById('upload-progress-container').classList.add('hidden');
Â  Â  Â  }
Â  Â  };

    document.getElementById('save-photo-btn').onclick = () => {
      const container = document.getElementById('upload-progress-container');
      const bar = document.getElementById('upload-progress-bar');
      const text = document.getElementById('upload-pct-text');
      
      container.classList.remove('hidden');
      document.getElementById('save-photo-btn').classList.add('hidden');
      
      let progress = 0;
      const interval = setInterval(() => {
        progress += Math.floor(Math.random() * 15) + 5;
        if (progress >= 100) {
          progress = 100;
          clearInterval(interval);
          setTimeout(() => {
            document.getElementById('upload-success').classList.remove('hidden');
            container.classList.add('hidden');
          }, 300);
        }
        bar.style.width = progress + '%';
        text.textContent = progress + '%';
      }, 150);
    };

    document.getElementById('upload-another-btn').onclick = () => {
      // å¾¹åº•åˆå§‹åŒ–
      document.getElementById('file-input').value = "";
      document.getElementById('image-preview').src = "";
      document.getElementById('photo-note').value = "";
      document.getElementById('upload-form-container').classList.add('hidden');
      document.getElementById('upload-success').classList.add('hidden');
      document.getElementById('save-photo-btn').classList.remove('hidden');
      document.getElementById('upload-progress-container').classList.add('hidden');
      document.getElementById('upload-progress-bar').style.width = '0%';
      document.getElementById('upload-pct-text').textContent = '0%';
    };

    document.getElementById('remove-image-btn').onclick = () => {
      document.getElementById('file-input').value = "";
      document.getElementById('upload-form-container').classList.add('hidden');
    };

    // å¯¶è²è³‡æ–™
    document.getElementById('avatar-input').onchange = (e) => {
      const file = e.target.files[0];
      if(file) {
        petAvatar = URL.createObjectURL(file);
        document.getElementById('pet-avatar-display').innerHTML = `<img src="${petAvatar}" class="w-full h-full object-cover">`;
      }
    };

    function loadProfile() {
      document.getElementById('profile-pet-name').textContent = petProfile.name;
      document.getElementById('profile-age').value = petProfile.age;
      document.getElementById('profile-type').value = petProfile.type;
	  document.getElementById('profile-gender').value = petProfile.gender;
      document.getElementById('profile-weight').value = petProfile.weight;
      document.getElementById('profile-breed').value = petProfile.breed;
      document.getElementById('profile-color').value = petProfile.color;
    }

    document.getElementById('save-profile-btn').onclick = () => {
      petProfile.age = document.getElementById('profile-age').value;
      petProfile.weight = document.getElementById('profile-weight').value;
      petProfile.breed = document.getElementById('profile-breed').value;
      petProfile.color = document.getElementById('profile-color').value;
      petProfile.type = document.getElementById('profile-type').value;
	  petProfile.gender = document.getElementById('profile-gender').value;
      showToast('è³‡æ–™å·²å„²å­˜ï¼âœ¨');
    };

    document.getElementById('back-btn').onclick = () => document.getElementById('detail-page').classList.add('hidden');
    document.getElementById('prev-month').onclick = () => { currentDate.setMonth(currentDate.getMonth() - 1); renderCalendar(); };
    document.getElementById('next-month').onclick = () => { currentDate.setMonth(currentDate.getMonth() + 1); renderCalendar(); };
    document.getElementById('logout-btn').onclick = () => location.reload();
  </script>
 </body>
</html>